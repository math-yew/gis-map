"use strict";(self.webpackChunkarcgis=self.webpackChunkarcgis||[]).push([[9391,3250],{25310:(ce,$,y)=>{y.d($,{a:()=>H});var _=y(26584),K=y(63290),R=y(39406),F=y(87526);function H(I){return(0,F.hj)(I.minDataValue)&&(0,F.hj)(I.maxDataValue)&&null!=I.minSize&&null!=I.maxSize?R.X.SIZE_MINMAX_VALUE:(I.expression&&"view.scale"===I.expression||I.valueExpression&&"$view.scale"===I.valueExpression)&&Array.isArray(I.stops)?R.X.SIZE_SCALE_STOPS:(null!=I.field||I.expression&&"view.scale"!==I.expression||I.valueExpression&&"$view.scale"!==I.valueExpression)&&(Array.isArray(I.stops)||"levels"in I&&I.levels)?R.X.SIZE_FIELD_STOPS:(null!=I.field||I.expression&&"view.scale"!==I.expression||I.valueExpression&&"$view.scale"!==I.valueExpression)&&null!=I.valueUnit?R.X.SIZE_UNIT_VALUE:(K.Z.getLogger("esri.views.2d.engine.webgl").error(new _.Z("mapview-bad-type","Found invalid size VisualVariable",I)),R.X.NONE)}},3250:(ce,$,y)=>{y.r($),y.d($,{createSymbolSchema:()=>H});var _=y(39406),K=y(18716);function R(x){return"line-marker"===x.type?{type:"line-marker",color:x.color?.toJSON(),placement:x.placement,style:x.style}:x.constructor.fromJSON(x.toJSON()).toJSON()}function F(x){return(0,K.hF)(x)}function H(x,E,P=!1){if(!x)return null;switch(x.type){case"simple-fill":case"picture-fill":return function Q(x,E,P){const V=(0,K.jj)(_.LW.FILL,E),C=P?F(V):V,N=x.clone(),d=N.outline,z=(0,K.jy)(E.symbologyType);z||(N.outline=null);const h={materialKey:C,hash:N.hash(),...R(N)};if(z)return h;const g=[];if(g.push(h),d){const S=(0,K.jj)(_.LW.LINE,{...E,isOutline:!0}),L={materialKey:P?F(S):S,hash:d.hash(),...R(d)};g.push(L)}return{type:"composite-symbol",layers:g,hash:g.reduce((S,L)=>L.hash+S,"")}}(x,E,P);case"simple-marker":case"picture-marker":return function w(x,E,P){const V=(0,K.jj)(_.LW.MARKER,E),C=P?F(V):V,N=R(x);return{materialKey:C,hash:x.hash(),...N,angle:x.angle,maxVVSize:E.maxVVSize}}(x,E,P);case"simple-line":return function Z(x,E,P){const V=(0,K.jy)(E.symbologyType)?_.mD.DEFAULT:E.symbologyType,C=(0,K.jj)(_.LW.LINE,{...E,symbologyType:V}),N=P?F(C):C,d=x.clone(),z=d.marker;d.marker=null;const h=[];if(h.push({materialKey:N,hash:d.hash(),...R(d)}),z){const g=(0,K.jj)(_.LW.MARKER,E),S=P?F(g):g;z.color=z.color??d.color,h.push({materialKey:S,hash:z.hash(),lineWidth:d.width,...R(z)})}return{type:"composite-symbol",layers:h,hash:h.reduce((g,S)=>S.hash+g,"")}}(x,E,P);case"text":return function J(x,E,P){const V=(0,K.jj)(_.LW.TEXT,E),C=P?F(V):V,N=R(x);return{materialKey:C,hash:x.hash(),...N,angle:x.angle,maxVVSize:E.maxVVSize}}(x,E,P);case"label":return function I(x,E,P){const V=x.toJSON(),C=(0,K.jj)(_.LW.LABEL,{...E,placement:V.labelPlacement});return{materialKey:P?F(C):C,hash:x.hash(),...V,labelPlacement:V.labelPlacement}}(x,E,P);case"cim":return{type:"cim",rendererKey:E.vvFlags,data:x.data,maxVVSize:E.maxVVSize};case"CIMSymbolReference":return{type:"cim",rendererKey:E.vvFlags,data:x,maxVVSize:E.maxVVSize};case"web-style":return{...R(x),type:"web-style",hash:x.hash(),rendererKey:E.vvFlags,maxVVSize:E.maxVVSize};default:throw new Error(`symbol not supported ${x.type}`)}}},49391:(ce,$,y)=>{y.d($,{MD:()=>be,Ew:()=>Ae,q5:()=>he});var _=y(26584),K=y(8314),R=y(63290),F=y(62208),H=y(23841),I=y(95737),Q=y(84682),Z=y(62667),w=y(39406),J=y(87526),x=y(25575),E=y(25310);function P(r){if(!r)return w.X.NONE;let u=0;for(const i of r)if("size"===i.type){const o=(0,E.a)(i);u|=o,"outline"===i.target&&(u|=o<<4)}else"color"===i.type?u|=w.X.COLOR:"opacity"===i.type?u|=w.X.OPACITY:"rotation"===i.type&&(u|=w.X.ROTATION);return u}var V=y(3250),N=(y(35909),y(31375));y(39351);function G(r,u){return Math.max(r,u)}y(64596),y(11263),new N.Z(0,0,24,24);var fe=y(22418),Oe=y(62192),Ve=y(43930);const oe=R.Z.getLogger("esri.views.2d.layers.features.schemaUtils"),Y="ValidationError";function he(r,u){let i=0,o=0,p=w.mD.DEFAULT;if((0,F.pC)(r)){if(o=function L(r,u){if(!("visualVariables"in r)||!r.hasVisualVariables("size"))return 0;const i=r.getVisualVariablesForType("size");if(!i[0])return 0;const o=i[0];if(u&&"cluster_count"===o.field&&"cluster"===u.type)return u.clusterMaxSize;if("outline"===o.target)return 0;if("stops"===o.transformationType)return o.stops.map(p=>p.size).reduce(G,0);if("clamped-linear"===o.transformationType){let p=-1/0,f=-1/0;return p="number"==typeof o.maxSize?o.maxSize:o.maxSize.stops.map(b=>b.size).reduce(G,0),f="number"==typeof o.minSize?o.minSize:o.minSize.stops.map(b=>b.size).reduce(G,0),Math.max(p,f)}return"real-world-size"===o.transformationType?30:void 0}(r,u),"visualVariables"in r&&(i=P(r.visualVariables||[]),"dot-density"===r.type&&(p=w.mD.DOT_DENSITY)),"heatmap"===r.type&&(p=w.mD.HEATMAP),"dictionary"===r.type)return{maxVVSize:o,vvFlags:i,symbologyType:w.mD.DEFAULT};if("pie-chart"===r.type)return{maxVVSize:o,vvFlags:i,symbologyType:w.mD.PIE_CHART};if(p!==w.mD.DOT_DENSITY&&p!==w.mD.HEATMAP){const f=r.getSymbols();"backgroundFillSymbol"in r&&r.backgroundFillSymbol&&f.push(r.backgroundFillSymbol);let b=!0,O=!0;for(const M of f)if("cim"===M.type&&(O=!1),"simple-fill"===M.type||"picture-fill"===M.type){const A=M.outline,W=A&&"none"!==A.style&&"solid"!==A.style;W&&(b=!1),("picture-fill"===M.type||"simple-fill"===M.type&&"none"!==M.style&&"solid"!==M.style||W)&&(O=!1)}b?p=O?w.mD.OUTLINE_FILL_SIMPLE:w.mD.OUTLINE_FILL:O&&(p=w.mD.SIMPLE)}}return{vvFlags:i,maxVVSize:o,symbologyType:p}}let De=null;function Ae(r){if((0,K.Z)("esri-2d-update-debug")){const u=Fe(r,!0);console.debug("Created new schema",u),console.debug("Schema diff",(0,Q.Hg)(De,u)),De=u}return Fe(r)}function Fe(r,u=!1){try{const i=function Ne(r,u=!1){const i=new Array;return i.push(function je(r,u,i=!1){const o={indexCount:0,fields:{}},p="featureReduction"in r?r.featureReduction??void 0:void 0,f=p?"aggregate":"feature";if("sublayers"in r){const ae={type:"subtype",subtypeField:r.subtypeField,renderers:{},symbologyType:w.mD.DEFAULT},xe={type:"subtype",mapping:{},target:"feature",subtypeField:r.subtypeField},ve={type:"subtype",classes:{}},rt={type:"symbol",target:"feature",aggregateFields:[],attributes:o,storage:xe,mesh:{matcher:ae,aggregateMatcher:null,labels:ve,sortKey:null}},_e=new Set;let st=0;for(const{renderer:pe,subtypeCode:ye,labelingInfo:it,labelsVisible:lt}of r.sublayers){let we=0;"visualVariables"in pe&&pe.visualVariables&&(pe.visualVariables.some(ge=>"rotation"!==ge.type)&&oe.warnOnce("SubtypeGroupLayer currently only supports rotation visualVariables. All other visualVariable types will be ignored."),we=P(pe.visualVariables.filter(ge=>"size"!==ge.type)));const Ue={symbologyType:w.mD.DEFAULT,vvFlags:we,maxVVSize:0},me=be(o,f,pe,Ue,i),de=Pe(o,f,pe),Ce=lt&&it;if("dictionary"===me.type)throw new _.Z(Y,"Dictionary renderer is not supported in subtype layers");if("subtype"===me.type)throw new _.Z(Y,"Nested subtype renderers is not supported");if((0,F.pC)(de)&&"subtype"===de.type)throw new _.Z(Y,"Nested subtype storage is not supported");if((0,F.pC)(de)&&(0,F.pC)(de.attributeMapping))throw new _.Z(Y,"Non-visual-variable attributes are not supported in subtype layers");if("heatmap"===me.type)throw new _.Z(Y,"Heatmaps are not supported in subtype layers");if("pie-chart"===me.type)throw new _.Z(Y,"Pie-charts are not supported in subtype layers");if(_e.has(ye))throw new _.Z(Y,"Subtype codes for sublayers must be unique");_e.add(ye),ae.renderers[ye]=me,xe.mapping[ye]=de,Ce&&(ve.classes[ye]=Ce.map(ge=>Me(o,ge,"feature",st++,Ue,i)))}return rt}if("heatmap"===r.renderer?.type&&"raster"===(0,fe.rk)()){const{radius:ae,fieldOffset:xe,field:ve}=r.renderer;return{type:"heatmap",aggregateFields:[],attributes:o,target:f,storage:null,mesh:{radius:ae,fieldOffset:xe,field:ie(o,{target:f,field:ve,resultType:"numeric"}).field}}}const b=function We(r,u,i){const o="featureReduction"in u&&u.featureReduction;if(!o)return{fields:[],labels:[],matcher:void 0,rendererOverride:void 0};const f=[];let b=null,O=(0,Ve.oq)(u.geometryType),M=[],A=null;if(o)switch(o.type){case"selection":return oe.error(new _.Z(Y,"Mapview does not support `selection` reduction type",o)),{fields:[],labels:[],matcher:void 0,rendererOverride:void 0};case"cluster":case"binning":if(f.push(...o.fields??[]),"cluster"===o.type?O="esriGeometryPoint":"binning"===o.type&&(O="esriGeometryPolygon"),o.renderer&&!o.renderer.authoringInfo?.isAutoGenerated){if("cluster"===o.type){const{renderer:re}=(0,Oe.st)(o.renderer,o,null);A=re}else A=o.renderer;const W=he(o.renderer,o);b=be(r,"aggregate",o.renderer,W,i),M=o&&o.labelsVisible&&o.labelingInfo||[]}else if("cluster"===o.type){if(A=(0,Oe.S1)(f,u.renderer,o,null,!0),o.symbol){const W=he(A,o);b={type:"simple",symbol:(0,V.createSymbolSchema)(o.symbol,W,i),symbologyType:W.symbologyType}}M=o&&o.labelsVisible&&o.labelingInfo||[]}}return function He(r,u){const i={mesh:!0,storage:!0};for(const o of u){const{name:p,onStatisticField:f,onStatisticExpression:b,statisticType:O}=o;let M,A;const W="numeric",re="feature";b?A=ue(r,{type:"expression",target:re,valueExpression:b.expression,resultType:W}).fieldIndex:M=ue(r,{type:"field",target:re,field:f,resultType:W}).field,ue(r,{type:"statistic",target:"aggregate",name:p,context:i,inField:M,inFieldIndex:A,statisticType:O})}}(r,f),{labels:(0,Z.a)(M,"binning"===o.type?"esriGeometryPolygon":O),matcher:b,fields:f,rendererOverride:A}}(o,r,i),O=(0,Ve.oq)(r.geometryType),M=b.rendererOverride??r.renderer,A=he(M,p),W=be(o,f,M,A,i),re=Pe(o,f,M),le=function Je(r,u,i,o){if((0,F.pC)(o))return null;if((0,F.pC)(u)&&u.length){u.length>1&&oe.warn(`Layer rendering currently only supports ordering by 1 orderByInfo, but found ${u.length}. All but the first will be discarded`);const p=u[0],f="ascending"===p.order?"asc":"desc";return p.field?{field:p.field,order:f}:p.valueExpression?{fieldIndex:ue(r,{type:"expression",target:"feature",valueExpression:p.valueExpression,resultType:"numeric"}).fieldIndex,order:f}:(oe.error(new _.Z(Y,"Expected to find a field or valueExpression for OrderByInfo",p)),null)}return(0,F.pC)(i)&&"unique-value"===i.type&&i.orderByClassesEnabled?{byRenderer:!0,order:"asc"}:null}(o,r.orderBy,r.renderer,p),tt=(0,Z.a)(r.labelsVisible&&r.labelingInfo||[],O);let ze=0;const nt=[...tt.map(ae=>Me(o,ae,"feature",ze++,A,i)),...b.labels.map(ae=>Me(o,ae,"aggregate",ze++,A,i))];return{type:"symbol",target:f,attributes:o,aggregateFields:b.fields,storage:re,mesh:{matcher:W,labels:{type:"simple",classes:nt},aggregateMatcher:b.matcher,sortKey:le}}}(r)),i}(r,u),o=function Ze(r){return"heatmap"===r.renderer?.type&&"raster"===(0,fe.rk)()?{type:"heatmap"}:{type:"symbol"}}(r),p={};i.map(O=>function Re(r,u,i){switch(i.target){case"feature":return void Te(r,Se(u),i);case"aggregate":{if(!("featureReduction"in u))return;const o=u.featureReduction;switch(o?.type){case"selection":throw new _.Z(Y,"Mapview does not support `selection` reduction type",o);case"binning":return Te(r,Se(u),i),void function Be(r,u,i,o){r.aggregate||(r.aggregate={name:"aggregate",type:"bin",filters:null,input:"feature",params:{fixedBinLevel:u.fixedBinLevel,fields:(u.fields??[]).map(p=>({...p.toJSON(),type:Le(p,i)}))},attributes:{}}),Ee(r.aggregate,o.attributes.fields)}(r,o,u.fields.map(p=>p.toJSON()),i);case"cluster":return Te(r,Se(u),i),void function Ke(r,u,i,o){r.aggregate||(r.aggregate={name:"aggregate",type:"cluster",input:"feature",filters:null,attributes:{},params:{clusterRadius:(0,H.F2)(u.clusterRadius/2),clusterPixelBuffer:64*Math.ceil((0,H.F2)(u.clusterMaxSize)/64),fields:(u.fields??[])?.map(p=>({...p.toJSON(),type:Le(p,i)}))}}),Ee(r.aggregate,o.attributes.fields)}(r,o,u.fields.map(p=>p.toJSON()),i)}}}}(p,r,O));const f=(0,F.pC)(r.subtypeCode)?`${r.subtypeField} = ${r.subtypeCode}`:null;return{source:{definitionExpression:(0,F.Wg)((0,I._)(r.definitionExpression,f)),fields:r.fields.map(O=>O.toJSON()),gdbVersion:r.gdbVersion,historicMoment:r.historicMoment?.getTime(),outFields:r.availableFields,pixelBuffer:r.pixelBuffer,spatialReference:r.spatialReference.toJSON(),timeExtent:r.timeExtent?.toJSON(),customParameters:r.customParameters},attributes:{fields:{},indexCount:0},processors:i,tileRenderer:o,targets:p}}catch(i){if(i.fieldName===Y)return oe.error(i),null;throw i}}function Ee(r,u){for(const i in u){const o=u[i];if(o.target!==r.name)continue;const p=r.attributes[i];if(p?.context){const f=p.context;f.mesh=f.mesh||o.context?.mesh,f.storage=f.storage||o.context?.storage}else r.attributes[i]=o}return r}function Se(r){return[(0,F.Wg)(r.filter)?.toJSON()??null,(0,F.Wg)((0,F.Wg)(r.featureEffect)?.filter)?.toJSON()??null]}function Te(r,u,i){return r.feature||(r.feature={name:"feature",input:"source",filters:u,attributes:{}}),Ee(r.feature,i.attributes.fields),r}function Le(r,u){const{onStatisticExpression:i,onStatisticField:o,statisticType:p}=r;switch(p){case"min":case"max":case"avg":case"avg_angle":case"sum":case"count":return"esriFieldTypeDouble";case"mode":{if(i){const{returnType:b}=i;return b?"string"===b?"esriFieldTypeString":"esriFieldTypeDouble":(oe.error(new _.Z(Y,"Unable to infer type of aggregateField with onStatisticExpression. ReturnType is not defined",r)),"esriFieldTypeString")}const f=u.find(b=>b.name===o);return f?f.type:(oe.error(new _.Z(Y,"Unable to infer type of aggregateField with onStatisticExpression. ReturnType is not defined",r)),"esriFieldTypeString")}}}function ie(r,u){return u.field?ue(r,{...u,type:"field",field:u.field}):u.valueExpression?ue(r,{...u,type:"expression",valueExpression:u.valueExpression}):{field:void 0,fieldIndex:void 0}}function ue(r,u){switch(u.type){case"expression":{const i=u.valueExpression;if(!r.fields[i]){const o=r.indexCount++;r.fields[i]={...u,name:i,fieldIndex:o}}return{fieldIndex:r.fields[i].fieldIndex}}case"label-expression":{const i=JSON.stringify(u.label);if(!r.fields[i]){const o=r.indexCount++;r.fields[i]={...u,name:i,fieldIndex:o}}return{fieldIndex:r.fields[i].fieldIndex}}case"field":{const i=u.field;return"aggregate"===u.target&&r.fields[i]||(r.fields[i]={...u,name:i}),{field:i}}case"statistic":return r.fields[u.name]={...u},{field:u.name}}}function Me(r,u,i,o,p,f=!1){const b=ue(r,{type:"label-expression",target:i,context:{mesh:!0},resultType:"string",label:{labelExpression:u.labelExpression,labelExpressionInfo:u.labelExpressionInfo?{expression:u.labelExpressionInfo.expression}:null,symbol:!!u.symbol,where:u.where}}),{fieldIndex:O}=b;return{...(0,V.createSymbolSchema)(u,p,f),fieldIndex:O,target:i,index:o}}function Pe(r,u,i){let o;switch(i.type){case"simple":case"class-breaks":case"unique-value":case"dictionary":o={visualVariables:!0,attributes:null};break;default:o=(0,x.EJ)(i).getStorageSpec(i)}return function Ge(r,u,i,o){if((0,F.Wi)(i))return null;const{visualVariables:p,attributes:f}=i;let b=null;p&&"visualVariables"in o&&(b=function Xe(r,u,i){if(!i||!i.length)return[];const o={storage:!0},p="numeric";return(0,fe.tv)(i).map(f=>{const b=(0,J.nU)(f.type),{field:O,fieldIndex:M}=ie(r,{target:u,valueExpression:f.valueExpression,field:f.field,context:o,resultType:p});switch(f.type){case"size":return"$view.scale"===f.valueExpression?null:{type:"size",binding:b,field:O,fieldIndex:M,normalizationField:ie(r,{target:u,field:f.normalizationField,context:o,resultType:p}).field,valueRepresentation:f.valueRepresentation??null};case"color":return{type:"color",binding:b,field:O,fieldIndex:M,normalizationField:ie(r,{target:u,field:f.normalizationField,context:o,resultType:p}).field};case"opacity":return{type:"opacity",binding:b,field:O,fieldIndex:M,normalizationField:ie(r,{target:u,field:f.normalizationField,context:o,resultType:p}).field};case"rotation":return{type:"rotation",binding:b,field:O,fieldIndex:M}}}).filter(F.pC)}(r,u,o.visualVariables));const O=(0,F.pC)(b)?4:0;let M=null;return(0,F.pC)(f)&&(M=f.map((A,W)=>{const{field:re,fieldIndex:le}=ie(r,{valueExpression:A.valueExpression,field:A.field,resultType:"numeric",target:u});return{binding:W+O,field:re,fieldIndex:le}})),{type:"simple",target:u,attributeMapping:M,vvMapping:b}}(r,u,o,i)}function be(r,u,i,o,p=!1){const f=(0,F.Pt)(r,{indexCount:0,fields:{}});switch(i.type){case"simple":case"dot-density":return function $e(r,u,i,o=!1){const p=u.getSymbols();return{type:"simple",symbol:(0,V.createSymbolSchema)(p.length?p[0]:null,i,o),symbologyType:i.symbologyType}}(0,i,o,p);case"class-breaks":return function Ye(r,u,i,o,p=!1){const b=i.backgroundFillSymbol,{field:O,fieldIndex:M}=ie(r,{target:u,field:i.field,valueExpression:i.valueExpression,resultType:"numeric",context:{mesh:!0,use:"renderer.field"}}),A=i.normalizationType,W="log"===A?"esriNormalizeByLog":"percent-of-total"===A?"esriNormalizeByPercentOfTotal":"field"===A?"esriNormalizeByField":null,re=i.classBreakInfos.map(le=>({symbol:(0,V.createSymbolSchema)(le.symbol,o,p),min:le.minValue,max:le.maxValue})).sort((le,Ie)=>le.min-Ie.min);return{type:"interval",attributes:r.fields,field:O,fieldIndex:M,backgroundFillSymbol:(0,V.createSymbolSchema)(b,o,p),defaultSymbol:(0,V.createSymbolSchema)(i.defaultSymbol,o,p),intervals:re,normalizationField:i.normalizationField,normalizationTotal:i.normalizationTotal,normalizationType:W,isMaxInclusive:i.isMaxInclusive,symbologyType:o.symbologyType}}(f,u,i,o,p);case"unique-value":return function Qe(r,u,i,o,p=!1){const f=[],b=i.backgroundFillSymbol,O={target:u,context:{mesh:!0},resultType:"string"};if(i.field&&"string"!=typeof i.field)throw new _.Z(Y,"Expected renderer.field to be a string",i);const{field:M,fieldIndex:A}=ie(r,{...O,field:i.field,valueExpression:i.valueExpression});for(const W of i.uniqueValueInfos??[])f.push({value:""+W.value,symbol:(0,V.createSymbolSchema)(W.symbol,o,p)});return{type:"map",attributes:r.fields,field:M,fieldIndex:A,field2:ie(r,{...O,field:i.field2}).field,field3:ie(r,{...O,field:i.field3}).field,fieldDelimiter:i.fieldDelimiter??void 0,backgroundFillSymbol:(0,V.createSymbolSchema)(b,o),defaultSymbol:(0,V.createSymbolSchema)(i.defaultSymbol,o),map:f,symbologyType:o.symbologyType}}(f,u,i,o,p);case"dictionary":return function qe(r,u,i,o=!1){return{type:"dictionary",config:u.config,fieldMap:u.fieldMap,scaleExpression:u.scaleExpression,url:u.url,symbolOptions:i,symbologyType:i.symbologyType}}(0,i,o,p);case"heatmap":return function et(r,u,i,o=!1){const p=u.getSymbols();return{type:"heatmap",symbol:(0,V.createSymbolSchema)(p.length?p[0]:null,i,o),symbologyType:i.symbologyType}}(0,i,o,p);case"pie-chart":return function ke(r,u,i,o=!1){const p=u.getSymbols(),b=p.length>1?p[1]:null;return{type:"pie-chart",markerSymbol:(0,V.createSymbolSchema)(p[0],i,o),fillSymbol:(0,V.createSymbolSchema)(b,i,o),symbologyType:i.symbologyType}}(0,i,o,p)}}},22418:(ce,$,y)=>{y.d($,{TT:()=>z,aR:()=>w,rk:()=>d,tv:()=>J});var _=y(26584),K=y(8314),R=y(63290),F=y(23841),H=y(31637);const I=8,Q=I-2,Z=R.Z.getLogger("esri.views.2d.layers.features.support.rendererUtils"),w=h=>{if(!("visualVariables"in h)||!h.visualVariables||!h.visualVariables.length)return h;const g=h.clone(),S=g.visualVariables.map(L=>x(L)?E(L):L);return g.visualVariables=S,g};function J(h){return h.map(g=>x(g)?E(g.clone()):g)}function x(h){return("size"===h.type||"color"===h.type||"opacity"===h.type)&&null!=h.stops}function E(h){return h.stops=function N(h,g){return g.length<=I?g:(Z.warn(`Found ${g.length} Visual Variable stops, but MapView only supports ${I}. Displayed stops will be simplified.`),g.length>2*I?function V(h,g){const[S,...L]=g,ne=L.pop(),se=L[0].value,k=L[L.length-1].value,v=(k-se)/Q,T=[];for(let D=se;D<k;D+=v){let U=0;for(;D>=L[U].value;)U++;const q=L[U],ee=g[U-1],X=q.value===ee.value?1:(D-ee.value)/(q.value-ee.value);if("color"===h){const B=L[U],te=g[U-1],G=B.color.clone();G.r=P(te.color.r,G.r,X),G.g=P(te.color.g,G.g,X),G.b=P(te.color.b,G.b,X),G.a=P(te.color.a,G.a,X),T.push({value:D,color:G,label:B.label})}else if("size"===h){const B=L[U],te=g[U-1],G=(0,F.t_)(B.size),fe=P((0,F.t_)(te.size),G,X);T.push({value:D,size:fe,label:B.label})}else{const B=L[U],te=P(g[U-1].opacity,B.opacity,X);T.push({value:D,opacity:te,label:B.label})}}return[S,...T,ne]}(h,g):function C(h){const[g,...S]=h,L=S.pop();for(;S.length>Q;){let ne=0,se=0;for(let k=1;k<S.length;k++){const D=Math.abs(S[k].value-S[k-1].value);D>se&&(se=D,ne=k)}S.splice(ne,1)}return[g,...S,L]}(g))}(h.type,h.stops??[]),h}function P(h,g,S){return(1-S)*h+S*g}function d(){if((0,K.Z)("heatmap-force-raster"))return"raster";const{supportsTextureFloat:h,supportsTextureHalfFloat:g,supportsColorBufferFloat:S,supportsColorBufferFloatBlend:L,supportsColorBufferHalfFloat:ne}=(0,H.hc)("2d");return h&&S&&L||g&&ne?"symbol":(0,K.Z)("heatmap-allow-raster-fallback")?"raster":"none"}function z(h){if(!h)return!0;switch(h.type){case"dot-density":if(!(0,H.hc)("2d").supportsTextureFloat)return Z.error(new _.Z("webgl-missing-extension","Missing WebGL extension OES_Texture_Float which is required for DotDensity")),!1;break;case"heatmap":{const g=d();if("none"===g||"raster"===g&&!(0,K.Z)("heatmap-force-raster")){const S=(0,H.hc)("2d"),L=["supportsTextureFloat","supportsTextureHalfFloat","supportsColorBufferFloat","supportsColorBufferFloatBlend","supportsColorBufferHalfFloat"].filter(ne=>!S[ne]).join(", ");if("none"===g)return Z.errorOnce(new _.Z("webgl-missing-extension",`Missing WebGL${S.type} requirements for Heatmap: ${L}`)),!1;"raster"===g&&Z.warnOnce(`Missing WebGL${S.type} requirements for accelerated Heatmap: ${L}. Feature support may be limited.`)}break}}return!0}},64596:(ce,$,y)=>{y.d($,{I_:()=>w,XA:()=>N,Zu:()=>x,ab:()=>E,eT:()=>V,y1:()=>J,yA:()=>P}),y(986);var K=y(62208),R=y(37118),F=y(65401),H=y(37053);y(61261),y(39351),y(25797);const w=512,J=50;function x(d,z){const h=(0,H.C5)(z);if(!h)return null;const[g,S]=h.valid;return d[2]>S?[(0,F.Ue)([d[0],d[1],S,d[3]]),(0,F.Ue)([g,d[1],g+d[2]-S,d[3]])]:d[0]<g?[(0,F.Ue)([g,d[1],d[2],d[3]]),(0,F.Ue)([S-(g-d[0]),d[1],S,d[3]])]:null}function E(d){return"text"===d||"esriTS"===d}function P(d){return"simple-marker"===d||"picture-marker"===d||"esriSMS"===d||"esriPMS"===d}function V(d){switch((0,K.Wg)(d.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0}function N(d){if(!d)return null;const{xmin:z,ymin:h,xmax:g,ymax:S,spatialReference:L}=d;return new R.Z({rings:[[[z,h],[z,S],[g,S],[g,h],[z,h]]],spatialReference:L})}},11263:(ce,$,y)=>{y.d($,{x:()=>k,B:()=>ne});var _=y(15861),K=y(13871),R=y(39406),F=y(18716);const H={marker:R.LW.MARKER,fill:R.LW.FILL,line:R.LW.LINE,text:R.LW.TEXT};class I{constructor(T,D,U,q){const ee={minScale:D?.minScale,maxScale:D?.maxScale},j=function Q(v){return v.minScale||v.maxScale?v.minScale+"-"+v.maxScale:""}(ee);this.layers=T,this.data=D,this.hash=this._createHash()+j,this.rendererKey=U;const X={isOutline:!1,placement:null,symbologyType:R.mD.DEFAULT,vvFlags:U};for(const B of T){const te=H[B.type];X.isOutline="line"===B.type&&B.isOutline,B.materialKey=(0,F.jj)(te,X),B.maxVVSize=q,B.scaleInfo=ee,B.templateHash+=j}}get type(){return"expanded-cim"}_createHash(){let T="";for(const D of this.layers)T+=D.templateHash;return T}}var Z=y(83100),w=y(26584),J=y(62208),x=y(10699),E=y(21726),P=y(84687),V=y(29840),C=y(71937);function N(v,T,D){return d.apply(this,arguments)}function d(){return d=(0,_.Z)(function*(v,T,D){if(!v.name)throw new w.Z("style-symbol-reference-name-missing","Missing name in style symbol reference");if(v.styleName&&"Esri2DPointSymbolsStyle"===v.styleName)return function z(v,T){return h.apply(this,arguments)}(v,D);try{return function g(v,T,D,U){return S.apply(this,arguments)}(yield(0,C.n2)(v,T,D),v.name,T,D)}catch(U){return(0,x.k_)(U),null}}),d.apply(this,arguments)}function h(){return(h=(0,_.Z)(function*(v,T){const D=C.wm.replace(/\{SymbolName\}/gi,v.name);try{const U=yield(0,C.EJ)(D,T);return(0,C.KV)(U.data)}catch(U){return(0,x.k_)(U),null}})).apply(this,arguments)}function S(){return(S=(0,_.Z)(function*(v,T,D,U){const q=v.data,ee={portal:D&&(0,J.pC)(D.portal)?D.portal:P.Z.getDefault(),url:(0,E.mN)(v.baseUrl),origin:"portal-item"},j=q.items.find(B=>B.name===T);if(!j)throw new w.Z("symbolstyleutils:symbol-name-not-found",`The symbol name '${T}' could not be found`,{symbolName:T});let X=(0,V.f)((0,C.v9)(j,"cimRef"),ee);(0,Z.XO)()&&(X=(0,Z.pJ)(X));try{const B=yield(0,C.EJ)(X,U);return(0,C.KV)(B.data)}catch(B){return(0,x.k_)(B),null}})).apply(this,arguments)}const L=function(){var v=(0,_.Z)(function*(T,D,U){return new I(yield(0,K.c)(T.data,D,U),T.data,T.rendererKey,T.maxVVSize)});return function(D,U,q){return v.apply(this,arguments)}}();function ne(v,T,D,U){return se.apply(this,arguments)}function se(){return(se=(0,_.Z)(function*(v,T,D,U){if(!v)return null;if("cim"===v.type)return L(v,T,D);if("web-style"===v.type){const q={type:"cim",data:(yield N(v,null,U))??void 0,rendererKey:v.rendererKey,maxVVSize:v.maxVVSize};return L(q,T,D)}return v})).apply(this,arguments)}function k(v){if(!v)return null;const{avoidSDFRasterization:T,type:D,cim:U,url:q,materialHash:ee}=v,j={cim:U,type:D,mosaicHash:ee,url:q,size:null,dashTemplate:null,path:null,text:null,fontName:null,animatedSymbolProperties:null,avoidSDFRasterization:T};switch(D){case"marker":j.size=v.size,j.path=v.path,j.animatedSymbolProperties=v.animatedSymbolProperties;break;case"line":j.dashTemplate=v.dashTemplate;break;case"text":j.text=v.text,j.fontName=v.fontName}return j}},43930:(ce,$,y)=>{y.d($,{JV:()=>H,oq:()=>R});const K=new(y(2076).X)({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function R(I){return K.toJSON(I)}function H(I){const{bandCount:Q,attributeTable:Z,colormap:w,pixelType:J}=I.raster.rasterInfo;return 1===Q&&(null!=Z||null!=w||"u8"===J||"s8"===J)}}}]);