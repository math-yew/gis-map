"use strict";(self.webpackChunkarcgis=self.webpackChunkarcgis||[]).push([[8742],{98148:(Z,M,y)=>{function O(b,c){const d=b.count;c||(c=new b.TypedArrayConstructor(d));for(let g=0;g<d;g++)c[g]=b.get(g);return c}y.d(M,{m:()=>O}),Object.freeze(Object.defineProperty({__proto__:null,copy:function h(b,c,d){const g=b.typedBuffer,o=b.typedBufferStride,l=c.typedBuffer,s=c.typedBufferStride,u=d?d.count:c.count;let r=(d&&d.dstIndex?d.dstIndex:0)*o,f=(d&&d.srcIndex?d.srcIndex:0)*s;for(let m=0;m<u;++m)g[r]=l[f],r+=o,f+=s},makeDense:O},Symbol.toStringTag,{value:"Module"}))},35995:(Z,M,y)=>{y.d(M,{f:()=>b,n:()=>N});var h=y(81096);function O(d,g,o){const l=d.typedBuffer,s=d.typedBufferStride,u=g.typedBuffer,r=g.typedBufferStride,f=o?o.count:g.count;let m=(o&&o.dstIndex?o.dstIndex:0)*s,x=(o&&o.srcIndex?o.srcIndex:0)*r;for(let T=0;T<f;++T)l[m]=u[x],l[m+1]=u[x+1],m+=s,x+=r}function N(d,g,o){const l=d.typedBuffer,s=d.typedBufferStride,u=g.typedBuffer,r=g.typedBufferStride,f=o?o.count:g.count;let m=(o&&o.dstIndex?o.dstIndex:0)*s,x=(o&&o.srcIndex?o.srcIndex:0)*r;if((0,h.U)(g.elementType)){const T=(0,h.Op)(g.elementType);if((0,h.B3)(g.elementType))for(let w=0;w<f;++w)l[m]=Math.max(u[x]/T,-1),l[m+1]=Math.max(u[x+1]/T,-1),m+=s,x+=r;else for(let w=0;w<f;++w)l[m]=u[x]/T,l[m+1]=u[x+1]/T,m+=s,x+=r}else O(d,g,o);return d}function b(d,g,o,l){const s=d.typedBuffer,u=d.typedBufferStride,r=l?.count??d.count;let f=(l?.dstIndex??0)*u;for(let m=0;m<r;++m)s[f]=g,s[f+1]=o,f+=u}Object.freeze(Object.defineProperty({__proto__:null,copy:O,fill:b,normalizeIntegerBuffer:N},Symbol.toStringTag,{value:"Module"}))},63657:(Z,M,y)=>{y.d(M,{a:()=>d,n:()=>b,s:()=>c,t:()=>N});var h=y(96286);function N(o,l,s){if(o.count!==l.count)return void h.c.error("source and destination buffers need to have the same number of elements");const u=o.count,r=s[0],f=s[1],m=s[2],x=s[3],T=s[4],w=s[5],v=s[6],B=s[7],U=s[8],L=o.typedBuffer,I=o.typedBufferStride,V=l.typedBuffer,ee=l.typedBufferStride;for(let H=0;H<u;H++){const k=H*I,W=H*ee,j=V[W],X=V[W+1],F=V[W+2],z=V[W+3];L[k]=r*j+x*X+v*F,L[k+1]=f*j+T*X+B*F,L[k+2]=m*j+w*X+U*F,L[k+3]=z}}function b(o,l){const s=Math.min(o.count,l.count),u=o.typedBuffer,r=o.typedBufferStride,f=l.typedBuffer,m=l.typedBufferStride;for(let x=0;x<s;x++){const T=x*r,w=x*m,v=f[w],B=f[w+1],U=f[w+2],L=v*v+B*B+U*U;if(L>0){const I=1/Math.sqrt(L);u[T]=I*v,u[T+1]=I*B,u[T+2]=I*U}}}function c(o,l,s){const u=Math.min(o.count,l.count),r=o.typedBuffer,f=o.typedBufferStride,m=l.typedBuffer,x=l.typedBufferStride;for(let T=0;T<u;T++){const w=T*f,v=T*x;r[w]=s*m[v],r[w+1]=s*m[v+1],r[w+2]=s*m[v+2],r[w+3]=s*m[v+3]}}function d(o,l,s){const u=Math.min(o.count,l.count),r=o.typedBuffer,f=o.typedBufferStride,m=l.typedBuffer,x=l.typedBufferStride;for(let T=0;T<u;T++){const w=T*f,v=T*x;r[w]=m[v]>>s,r[w+1]=m[v+1]>>s,r[w+2]=m[v+2]>>s,r[w+3]=m[v+3]>>s}}Object.freeze(Object.defineProperty({__proto__:null,normalize:b,scale:c,shiftRight:d,transformMat3:N,transformMat4:function O(o,l,s){if(o.count!==l.count)return void h.c.error("source and destination buffers need to have the same number of elements");const u=o.count,r=s[0],f=s[1],m=s[2],x=s[3],T=s[4],w=s[5],v=s[6],B=s[7],U=s[8],L=s[9],I=s[10],V=s[11],ee=s[12],H=s[13],k=s[14],W=s[15],j=o.typedBuffer,X=o.typedBufferStride,F=l.typedBuffer,z=l.typedBufferStride;for(let P=0;P<u;P++){const $=P*X,J=P*z,K=F[J],Y=F[J+1],Q=F[J+2],q=F[J+3];j[$]=r*K+T*Y+U*Q+ee*q,j[$+1]=f*K+w*Y+L*Q+H*q,j[$+2]=m*K+v*Y+I*Q+k*q,j[$+3]=x*K+B*Y+V*Q+W*q}}},Symbol.toStringTag,{value:"Module"}))},63470:(Z,M,y)=>{function h(b,c,d){const g=b.typedBuffer,o=b.typedBufferStride,l=c.typedBuffer,s=c.typedBufferStride,u=d?d.count:c.count;let r=(d&&d.dstIndex?d.dstIndex:0)*o,f=(d&&d.srcIndex?d.srcIndex:0)*s;for(let m=0;m<u;++m)g[r]=l[f],g[r+1]=l[f+1],g[r+2]=l[f+2],g[r+3]=l[f+3],r+=o,f+=s}function O(b,c,d,g,o,l){const s=b.typedBuffer,u=b.typedBufferStride,r=l?.count??b.count;let f=(l?.dstIndex??0)*u;for(let m=0;m<r;++m)s[f]=c,s[f+1]=d,s[f+2]=g,s[f+3]=o,f+=u}y.d(M,{c:()=>h,f:()=>O}),Object.freeze(Object.defineProperty({__proto__:null,copy:h,fill:O},Symbol.toStringTag,{value:"Module"}))},81096:(Z,M,y)=>{function h(c){switch(c){case"u8":case"i8":return 1;case"u16":case"i16":return 2;case"u32":case"i32":case"f32":return 4;case"f64":return 8}}function O(c){switch(c){case"u8":case"u16":case"u32":return!1;case"i8":case"i16":case"i32":case"f32":case"f64":return!0}}function N(c){switch(c){case"u8":case"u16":case"u32":case"i8":case"i16":case"i32":return!0;case"f32":case"f64":return!1}}function b(c){switch(c){case"u8":return 255;case"u16":return 65535;case"u32":return 4294967295;case"i8":return 127;case"i16":return 32767;case"i32":return 2147483647;case"f32":return 3402823e32;case"f64":return 179769e303}}y.d(M,{B3:()=>O,Op:()=>b,U:()=>N,n1:()=>h})},60490:(Z,M,y)=>{y.d(M,{gS:()=>s});var h=y(81096);function s(u,r){return new u(new ArrayBuffer(r*u.ElementCount*(0,h.n1)(u.ElementType)))}Object.freeze(Object.defineProperty({__proto__:null,copy:function O(u,r,f){const m=u.typedBuffer,x=u.typedBufferStride,T=r.typedBuffer,w=r.typedBufferStride,v=f?f.count:r.count;let B=(f&&f.dstIndex?f.dstIndex:0)*x,U=(f&&f.srcIndex?f.srcIndex:0)*w;for(let L=0;L<v;++L){for(let I=0;I<9;++I)m[B+I]=T[U+I];B+=x,U+=w}}},Symbol.toStringTag,{value:"Module"})),Object.freeze(Object.defineProperty({__proto__:null,copy:function b(u,r,f){const m=u.typedBuffer,x=u.typedBufferStride,T=r.typedBuffer,w=r.typedBufferStride,v=f?f.count:r.count;let B=(f&&f.dstIndex?f.dstIndex:0)*x,U=(f&&f.srcIndex?f.srcIndex:0)*w;for(let L=0;L<v;++L){for(let I=0;I<16;++I)m[B+I]=T[U+I];B+=x,U+=w}}},Symbol.toStringTag,{value:"Module"})),y(98148),y(35995),y(9554),y(63470)},9160:(Z,M,y)=>{y.d(M,{C:()=>o});var h=y(15861),O=y(84792),N=y(59213),b=y(26584),c=y(62208),d=y(10699),g=y(21726);class o{constructor(u){this._streamDataRequester=u}loadJSON(u,r){var f=this;return(0,h.Z)(function*(){return f._load("json",u,r)})()}loadBinary(u,r){var f=this;return(0,h.Z)(function*(){return(0,g.HK)(u)?((0,d.k_)(r),(0,g.AH)(u)):f._load("binary",u,r)})()}loadImage(u,r){var f=this;return(0,h.Z)(function*(){return f._load("image",u,r)})()}_load(u,r,f){var m=this;return(0,h.Z)(function*(){if((0,c.Wi)(m._streamDataRequester))return(yield(0,O.default)(r,{responseType:l[u]})).data;const x=yield(0,N.q6)(m._streamDataRequester.request(r,u,f));if(!0===x.ok)return x.value;throw(0,d.r9)(x.error),new b.Z("",`Request for resource failed: ${x.error}`)})()}}const l={image:"image",binary:"array-buffer",json:"json"}},96170:(Z,M,y)=>{y.d(M,{DA:()=>b,jX:()=>c,nh:()=>N});var h=y(55713),O=y(37187);function N(d,g=O.p){return"number"==typeof d?g(d):(0,h.Uc)(d)||(0,h.lq)(d)?new Uint32Array(d):d}function b(d){const g="number"==typeof d?d:d.length;if(g<3)return[];const o=g-2,l=(0,O.$z)(o);if("number"==typeof d){let s=0;for(let u=0;u<o;u+=1)u%2==0?(l[s++]=u,l[s++]=u+1,l[s++]=u+2):(l[s++]=u+1,l[s++]=u,l[s++]=u+2)}else{let s=0;for(let u=0;u<o;u+=1)if(u%2==0){const f=d[u+1],m=d[u+2];l[s++]=d[u],l[s++]=f,l[s++]=m}else{const f=d[u],m=d[u+2];l[s++]=d[u+1],l[s++]=f,l[s++]=m}}return l}function c(d){const g="number"==typeof d?d:d.length;if(g<3)return new Uint16Array(0);const o=g-2,l=o<=65536?new Uint16Array(3*o):new Uint32Array(3*o);if("number"==typeof d){let s=0;for(let u=0;u<o;++u)l[s++]=0,l[s++]=u+1,l[s++]=u+2;return l}{const s=d[0];let u=d[1],r=0;for(let f=0;f<o;++f){const m=d[f+2];l[r++]=s,l[r++]=u,l[r++]=m,u=m}return l}}},19574:(Z,M,y)=>{y.d(M,{$A:()=>b,Ml:()=>g,NM:()=>N,i$:()=>c});var h=y(15861),O=y(42743);class N{constructor(s){this.data=s,this.type="encoded-mesh-texture",this.encoding=O.Ti.KTX2_ENCODING}}function b(l){return"encoded-mesh-texture"===l?.type}function c(l){return d.apply(this,arguments)}function d(){return(d=(0,h.Z)(function*(l){return new Promise((s,u)=>{const r=new Blob([l]),f=new FileReader;f.onload=()=>{s(JSON.parse(f.result))},f.onerror=m=>{u(m)},f.readAsText(r)})})).apply(this,arguments)}function g(l,s){return o.apply(this,arguments)}function o(){return(o=(0,h.Z)(function*(l,s){return s===O.Ti.KTX2_ENCODING?new N(l):new Promise((u,r)=>{const f=new Blob([l],{type:s}),m=URL.createObjectURL(f),x=new Image,T=()=>{URL.revokeObjectURL(m),"decode"in x?x.decode().then(()=>u(x),()=>u(x)).then(v):(u(x),v())},w=B=>{URL.revokeObjectURL(m),r(B),v()},v=()=>{x.removeEventListener("load",T),x.removeEventListener("error",w)};x.addEventListener("load",T),x.addEventListener("error",w),x.src=m})})).apply(this,arguments)}},12495:(Z,M,y)=>{y.d(M,{Q:()=>pe});var B,U,i,h=y(15861),O=y(63290),N=y(62208),b=y(43703),c=y(67969),o=y(26584),l=y(88159),s=y(10699),u=y(21726),r=y(10349),f=y(28347),m=y(48977),x=y(78451),T=y(60479),w=y(98148);class v{constructor(t){this._data=t,this._offset4=0,this._dataUint32=new Uint32Array(this._data,0,Math.floor(this._data.byteLength/4))}readUint32(){const t=this._offset4;return this._offset4+=1,this._dataUint32[t]}readUint8Array(t){const n=4*this._offset4;return this._offset4+=t/4,new Uint8Array(this._data,n,t)}remainingBytes(){return this._data.byteLength-4*this._offset4}}(i=B||(B={})).SCALAR="SCALAR",i.VEC2="VEC2",i.VEC3="VEC3",i.VEC4="VEC4",i.MAT2="MAT2",i.MAT3="MAT3",i.MAT4="MAT4",function(i){i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER"}(U||(U={}));var L=y(94573);const I={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1},V={pbrMetallicRoughness:I,emissiveFactor:[0,0,0],alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1},ee={ESRI_externalColorMixMode:"tint"},H=(i={})=>{const t={...I,...i.pbrMetallicRoughness},n=function k(i){switch(i.ESRI_externalColorMixMode){case"multiply":case"tint":case"ignore":case"replace":break;default:(0,L.Bg)(i.ESRI_externalColorMixMode),i.ESRI_externalColorMixMode="tint"}return i}({...ee,...i.extras});return{...V,...i,pbrMetallicRoughness:t,extras:n}},W={magFilter:c.cw.LINEAR,minFilter:c.cw.LINEAR_MIPMAP_LINEAR,wrapS:c.e8.REPEAT,wrapT:c.e8.REPEAT};var F=y(19574);class P{constructor(t,n,a,e){if(this._context=t,this.uri=n,this.json=a,this._glbBuffer=e,this._bufferLoaders=new Map,this._textureLoaders=new Map,this._textureCache=new Map,this._materialCache=new Map,this._nodeParentMap=new Map,this._nodeTransformCache=new Map,this._supportedExtensions=["KHR_texture_basisu"],this._baseUri=function X(i){let t,n;return i.replace(/^(.*\/)?([^/]*)$/,(a,e,p)=>(t=e||"",n=p||"","")),{dirPart:t,filePart:n}}(this.uri).dirPart,this._checkVersionSupported(),this._checkRequiredExtensionsSupported(),null==a.scenes)throw new o.Z("gltf-loader-unsupported-feature","Scenes must be defined.");if(null==a.meshes)throw new o.Z("gltf-loader-unsupported-feature","Meshes must be defined");if(null==a.nodes)throw new o.Z("gltf-loader-unsupported-feature","Nodes must be defined.");this._computeNodeParents()}static load(t,n,a){var e=this;return(0,h.Z)(function*(){if((0,u.HK)(n)){const E=(0,u.sJ)(n);if(E&&"model/gltf-binary"!==E.mediaType)try{const C=JSON.parse(E.isBase64?atob(E.data):E.data);return new P(t,n,C)}catch{}const A=(0,u.AH)(n);if(P._isGLBData(A))return e._fromGLBData(t,n,A)}if(n.endsWith(".gltf")){const E=yield t.loadJSON(n,a);return new P(t,n,E)}const p=yield t.loadBinary(n,a);if(P._isGLBData(p))return e._fromGLBData(t,n,p);const _=yield t.loadJSON(n,a);return new P(t,n,_)})()}static _isGLBData(t){if(null==t)return!1;const n=new v(t);return n.remainingBytes()>=4&&1179937895===n.readUint32()}static _fromGLBData(t,n,a){return(0,h.Z)(function*(){const e=yield P._parseGLBData(a);return new P(t,n,e.json,e.binaryData)})()}static _parseGLBData(t){return(0,h.Z)(function*(){const n=new v(t);if(n.remainingBytes()<12)throw new o.Z("gltf-loader-error","GLB binary data is insufficiently large.");const a=n.readUint32(),e=n.readUint32(),p=n.readUint32();if(1179937895!==a)throw new o.Z("gltf-loader-error","Magic first 4 bytes do not fit to expected GLB value.");if(t.byteLength<p)throw new o.Z("gltf-loader-error","GLB binary data is smaller than header specifies.");if(2!==e)throw new o.Z("gltf-loader-unsupported-feature","An unsupported GLB container version was detected. Only version 2 is supported.");let _,E,A=0;for(;n.remainingBytes()>=8;){const C=n.readUint32(),R=n.readUint32();if(0===A){if(1313821514!==R)throw new o.Z("gltf-loader-error","First GLB chunk must be JSON.");if(C<0)throw new o.Z("gltf-loader-error","No JSON data found.");_=yield(0,F.i$)(n.readUint8Array(C))}else if(1===A){if(5130562!==R)throw new o.Z("gltf-loader-unsupported-feature","Second GLB chunk expected to be BIN.");E=n.readUint8Array(C)}else O.Z.getLogger("esri.views.3d.glTF").warn("[Unsupported Feature] More than 2 GLB chunks detected. Skipping.");A+=1}if(!_)throw new o.Z("gltf-loader-error","No GLB JSON chunk detected.");return{json:_,binaryData:E}})()}getBuffer(t,n){var a=this;return(0,h.Z)(function*(){const e=a.json.buffers[t];if(null==e.uri){if(null==a._glbBuffer)throw new o.Z("gltf-loader-error","GLB buffer not present");return a._glbBuffer}const p=yield a._getBufferLoader(t,n);if(p.byteLength!==e.byteLength)throw new o.Z("gltf-loader-error","Buffer byte lengths should match.");return p})()}_getBufferLoader(t,n){var a=this;return(0,h.Z)(function*(){const e=a._bufferLoaders.get(t);if(e)return e;const _=a._context.loadBinary(a._resolveUri(a.json.buffers[t].uri),n).then(E=>new Uint8Array(E));return a._bufferLoaders.set(t,_),_})()}getAccessor(t,n){var a=this;return(0,h.Z)(function*(){if(!a.json.accessors)throw new o.Z("gltf-loader-unsupported-feature","Accessors missing.");const e=a.json.accessors[t];if(null==e?.bufferView)throw new o.Z("gltf-loader-unsupported-feature","Some accessor does not specify a bufferView.");if(e.type in[B.MAT2,B.MAT3,B.MAT4])throw new o.Z("gltf-loader-unsupported-feature",`AttributeType ${e.type} is not supported`);const p=a.json.bufferViews[e.bufferView],_=yield a.getBuffer(p.buffer,n),E=Y[e.type],A=Q[e.componentType],C=E*A,R=p.byteStride||C;return{raw:_.buffer,byteStride:R,byteOffset:_.byteOffset+(p.byteOffset||0)+(e.byteOffset||0),entryCount:e.count,isDenselyPacked:R===C,componentCount:E,componentByteSize:A,componentType:e.componentType,min:e.min,max:e.max,normalized:!!e.normalized}})()}getIndexData(t,n){var a=this;return(0,h.Z)(function*(){if(null==t.indices)return;const e=yield a.getAccessor(t.indices,n);if(e.isDenselyPacked)switch(e.componentType){case c.g.UNSIGNED_BYTE:return new Uint8Array(e.raw,e.byteOffset,e.entryCount);case c.g.UNSIGNED_SHORT:return new Uint16Array(e.raw,e.byteOffset,e.entryCount);case c.g.UNSIGNED_INT:return new Uint32Array(e.raw,e.byteOffset,e.entryCount)}else switch(e.componentType){case c.g.UNSIGNED_BYTE:return(0,w.m)(a._wrapAccessor(T.D_,e));case c.g.UNSIGNED_SHORT:return(0,w.m)(a._wrapAccessor(T.av,e));case c.g.UNSIGNED_INT:return(0,w.m)(a._wrapAccessor(T.Nu,e))}})()}getPositionData(t,n){var a=this;return(0,h.Z)(function*(){if(null==t.attributes.POSITION)throw new o.Z("gltf-loader-unsupported-feature","No POSITION vertex data found.");const e=yield a.getAccessor(t.attributes.POSITION,n);if(e.componentType!==c.g.FLOAT)throw new o.Z("gltf-loader-unsupported-feature","Expected type FLOAT for POSITION vertex attribute, but found "+c.g[e.componentType]);if(3!==e.componentCount)throw new o.Z("gltf-loader-unsupported-feature","POSITION vertex attribute must have 3 components, but found "+e.componentCount.toFixed());return a._wrapAccessor(T.ct,e)})()}getNormalData(t,n){var a=this;return(0,h.Z)(function*(){if(null==t.attributes.NORMAL)throw new o.Z("gltf-loader-error","No NORMAL vertex data found.");const e=yield a.getAccessor(t.attributes.NORMAL,n);if(e.componentType!==c.g.FLOAT)throw new o.Z("gltf-loader-unsupported-feature","Expected type FLOAT for NORMAL vertex attribute, but found "+c.g[e.componentType]);if(3!==e.componentCount)throw new o.Z("gltf-loader-unsupported-feature","NORMAL vertex attribute must have 3 components, but found "+e.componentCount.toFixed());return a._wrapAccessor(T.ct,e)})()}getTangentData(t,n){var a=this;return(0,h.Z)(function*(){if(null==t.attributes.TANGENT)throw new o.Z("gltf-loader-error","No TANGENT vertex data found.");const e=yield a.getAccessor(t.attributes.TANGENT,n);if(e.componentType!==c.g.FLOAT)throw new o.Z("gltf-loader-unsupported-feature","Expected type FLOAT for TANGENT vertex attribute, but found "+c.g[e.componentType]);if(4!==e.componentCount)throw new o.Z("gltf-loader-unsupported-feature","TANGENT vertex attribute must have 4 components, but found "+e.componentCount.toFixed());return new T.ek(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount)})()}getTextureCoordinates(t,n){var a=this;return(0,h.Z)(function*(){if(null==t.attributes.TEXCOORD_0)throw new o.Z("gltf-loader-error","No TEXCOORD_0 vertex data found.");const e=yield a.getAccessor(t.attributes.TEXCOORD_0,n);if(2!==e.componentCount)throw new o.Z("gltf-loader-unsupported-feature","TEXCOORD_0 vertex attribute must have 2 components, but found "+e.componentCount.toFixed());if(e.componentType===c.g.FLOAT)return a._wrapAccessor(T.Eu,e);if(!e.normalized)throw new o.Z("gltf-loader-unsupported-feature","Integer component types are only supported for a normalized accessor for TEXCOORD_0.");return function q(i){switch(i.componentType){case c.g.BYTE:return new T.Vs(i.raw,i.byteOffset,i.byteStride,i.byteOffset+i.byteStride*i.entryCount);case c.g.UNSIGNED_BYTE:return new T.xA(i.raw,i.byteOffset,i.byteStride,i.byteOffset+i.byteStride*i.entryCount);case c.g.SHORT:return new T.or(i.raw,i.byteOffset,i.byteStride,i.byteOffset+i.byteStride*i.entryCount);case c.g.UNSIGNED_SHORT:return new T.TS(i.raw,i.byteOffset,i.byteStride,i.byteOffset+i.byteStride*i.entryCount);case c.g.UNSIGNED_INT:return new T.qt(i.raw,i.byteOffset,i.byteStride,i.byteOffset+i.byteStride*i.entryCount);case c.g.FLOAT:return new T.Eu(i.raw,i.byteOffset,i.byteStride,i.byteOffset+i.byteStride*i.entryCount)}}(e)})()}getVertexColors(t,n){var a=this;return(0,h.Z)(function*(){if(null==t.attributes.COLOR_0)throw new o.Z("gltf-loader-error","No COLOR_0 vertex data found.");const e=yield a.getAccessor(t.attributes.COLOR_0,n);if(4!==e.componentCount&&3!==e.componentCount)throw new o.Z("gltf-loader-unsupported-feature","COLOR_0 attribute must have 3 or 4 components, but found "+e.componentCount.toFixed());if(4===e.componentCount){if(e.componentType===c.g.FLOAT)return a._wrapAccessor(T.ek,e);if(e.componentType===c.g.UNSIGNED_BYTE)return a._wrapAccessor(T.mc,e);if(e.componentType===c.g.UNSIGNED_SHORT)return a._wrapAccessor(T.v6,e)}else if(3===e.componentCount){if(e.componentType===c.g.FLOAT)return a._wrapAccessor(T.ct,e);if(e.componentType===c.g.UNSIGNED_BYTE)return a._wrapAccessor(T.ne,e);if(e.componentType===c.g.UNSIGNED_SHORT)return a._wrapAccessor(T.mw,e)}throw new o.Z("gltf-loader-unsupported-feature","Unsupported component type for COLOR_0 attribute: "+c.g[e.componentType])})()}hasPositions(t){return void 0!==t.attributes.POSITION}hasNormals(t){return void 0!==t.attributes.NORMAL}hasVertexColors(t){return void 0!==t.attributes.COLOR_0}hasTextureCoordinates(t){return void 0!==t.attributes.TEXCOORD_0}hasTangents(t){return void 0!==t.attributes.TANGENT}getMaterial(t,n,a){var e=this;return(0,h.Z)(function*(){let p=t.material?e._materialCache.get(t.material):void 0;if(!p){const _=null!=t.material?H(e.json.materials[t.material]):H(),E=_.pbrMetallicRoughness,A=e.hasVertexColors(t),C=e.getTexture(E.baseColorTexture,n),R=e.getTexture(_.normalTexture,n),S=a?e.getTexture(_.occlusionTexture,n):void 0,D=a?e.getTexture(_.emissiveTexture,n):void 0,G=a?e.getTexture(E.metallicRoughnessTexture,n):void 0,re=null!=t.material?t.material:-1;p={alphaMode:_.alphaMode,alphaCutoff:_.alphaCutoff,color:E.baseColorFactor,doubleSided:!!_.doubleSided,colorTexture:yield C,normalTexture:yield R,name:_.name,id:re,occlusionTexture:yield S,emissiveTexture:yield D,emissiveFactor:_.emissiveFactor,metallicFactor:E.metallicFactor,roughnessFactor:E.roughnessFactor,metallicRoughnessTexture:yield G,hasVertexColors:A,ESRI_externalColorMixMode:_.extras.ESRI_externalColorMixMode,colorTextureTransform:E?.baseColorTexture?.extensions?.KHR_texture_transform,normalTextureTransform:_.normalTexture?.extensions?.KHR_texture_transform,occlusionTextureTransform:_.occlusionTexture?.extensions?.KHR_texture_transform,emissiveTextureTransform:_.emissiveTexture?.extensions?.KHR_texture_transform,metallicRoughnessTextureTransform:E?.metallicRoughnessTexture?.extensions?.KHR_texture_transform}}return p})()}getTexture(t,n){var a=this;return(0,h.Z)(function*(){if(!t)return;if(0!==(t.texCoord||0))throw new o.Z("gltf-loader-unsupported-feature","Only TEXCOORD with index 0 is supported.");const e=t.index,p=a.json.textures[e],_=(i=>({...W,...i}))(null!=p.sampler?a.json.samplers[p.sampler]:{}),E=a._getTextureSourceId(p),A=a.json.images[E],C=yield a._loadTextureImageData(e,p,n);return(0,l.s1)(a._textureCache,e,()=>{const R=D=>33071===D||33648===D||10497===D,S=D=>{throw new o.Z("gltf-loader-error",`Unexpected TextureSampler WrapMode: ${D}`)};return{data:C,wrapS:R(_.wrapS)?_.wrapS:S(_.wrapS),wrapT:R(_.wrapT)?_.wrapT:S(_.wrapT),minFilter:_.minFilter,name:A.name,id:e}})})()}getNodeTransform(t){if(void 0===t)return $;let n=this._nodeTransformCache.get(t);if(!n){const a=this.getNodeTransform(this._getNodeParent(t)),e=this.json.nodes[t];e.matrix?n=(0,f.m)((0,b.c)(),a,e.matrix):e.translation||e.rotation||e.scale?(n=(0,b.b)(a),e.translation&&(0,f.w)(n,n,e.translation),e.rotation&&(K[3]=(0,m.g)(K,e.rotation),(0,f.e)(n,n,K[3],K)),e.scale&&(0,f.k)(n,n,e.scale)):n=(0,b.b)(a),this._nodeTransformCache.set(t,n)}return n}_wrapAccessor(t,n){return new t(n.raw,n.byteOffset,n.byteStride,n.byteOffset+n.byteStride*(n.entryCount-1)+n.componentByteSize*n.componentCount)}_resolveUri(t){return(0,u.hF)(t,this._baseUri)}_getNodeParent(t){return this._nodeParentMap.get(t)}_checkVersionSupported(){const t=r.G.parse(this.json.asset.version,"glTF");J.validate(t)}_checkRequiredExtensionsSupported(){const t=this.json;if(t.extensionsRequired&&!t.extensionsRequired.every(n=>this._supportedExtensions.includes(n)))throw new o.Z("gltf-loader-unsupported-feature","gltf loader was not able to load unsupported feature. Required extensions: "+t.extensionsRequired.join(", "))}_computeNodeParents(){this.json.nodes.forEach((t,n)=>{t.children&&t.children.forEach(a=>{this._nodeParentMap.set(a,n)})})}_loadTextureImageData(t,n,a){var e=this;return(0,h.Z)(function*(){const p=e._textureLoaders.get(t);if(p)return p;const _=e._createTextureLoader(n,a);return e._textureLoaders.set(t,_),_})()}_getTextureSourceId(t){if(void 0!==t.extensions&&null!==t.extensions.KHR_texture_basisu)return t.extensions.KHR_texture_basisu.source;if(null!==t.source)return t.source;throw new o.Z("gltf-loader-unsupported-feature","Source is expected to be defined for a texture. It can also be omitted in favour of an KHR_texture_basisu extension tag.")}_createTextureLoader(t,n){var a=this;return(0,h.Z)(function*(){const e=a._getTextureSourceId(t),p=a.json.images[e];if(p.uri){if(p.uri.endsWith(".ktx2")){const C=yield a._context.loadBinary(a._resolveUri(p.uri),n);return new F.NM(new Uint8Array(C))}return a._context.loadImage(a._resolveUri(p.uri),n)}if(null==p.bufferView)throw new o.Z("gltf-loader-unsupported-feature","Image bufferView must be defined.");if(null==p.mimeType)throw new o.Z("gltf-loader-unsupported-feature","Image mimeType must be defined.");const _=a.json.bufferViews[p.bufferView],E=yield a.getBuffer(_.buffer,n);if(null!=_.byteStride)throw new o.Z("gltf-loader-unsupported-feature","byteStride not supported for image buffer");return(0,F.Ml)(new Uint8Array(E.buffer,E.byteOffset+(_.byteOffset||0),_.byteLength),p.mimeType)})()}getLoadedBuffersSize(){var t=this;return(0,h.Z)(function*(){if(t._glbBuffer)return t._glbBuffer.byteLength;const n=yield(0,s.WW)(Array.from(t._bufferLoaders.values())),a=yield(0,s.WW)(Array.from(t._textureLoaders.values()));return n.reduce((e,p)=>e+(p?.byteLength??0),0)+a.reduce((e,p)=>e+(p?(0,F.$A)(p)?p.data.byteLength:p.width*p.height*4:0),0)})()}}const $=(0,f.A)((0,b.c)(),Math.PI/2),J=new r.G(2,0,"glTF"),K=(0,x.a)(),Y={SCALAR:1,VEC2:2,VEC3:3,VEC4:4},Q={[c.g.BYTE]:1,[c.g.UNSIGNED_BYTE]:1,[c.g.SHORT]:2,[c.g.UNSIGNED_SHORT]:2,[c.g.FLOAT]:4,[c.g.UNSIGNED_INT]:4};let de=0;function pe(i,t){return ne.apply(this,arguments)}function ne(){return ne=(0,h.Z)(function*(i,t,n={},a=!0){const e=yield P.load(i,t,n),p="gltf_"+de++,_={lods:[],materials:new Map,textures:new Map,meta:me(e)},E=!(!e.json.asset.extras||"symbolResource"!==e.json.asset.extras.ESRI_type),A=new Map;yield function _e(i,t){return oe.apply(this,arguments)}(e,function(){var R=(0,h.Z)(function*(S,D,G,re){const se=A.get(G)??0;A.set(G,se+1);const te=void 0!==S.mode?S.mode:c.MX.TRIANGLES,ae=te===c.MX.TRIANGLES||te===c.MX.TRIANGLE_STRIP||te===c.MX.TRIANGLE_FAN?te:null;if((0,N.Wi)(ae))return void O.Z.getLogger("esri.views.3d.glTF").warn("[Unsupported Feature] Unsupported primitive mode ("+c.MX[te]+"). Skipping primitive.");if(!e.hasPositions(S))return void O.Z.getLogger("esri.views.3d.glTF").warn("Skipping primitive without POSITION vertex attribute.");const ge=e.getPositionData(S,n),xe=e.getMaterial(S,n,a),ue=e.hasNormals(S)?e.getNormalData(S,n):null,ie=e.hasTangents(S)?e.getTangentData(S,n):null,ce=e.hasTextureCoordinates(S)?e.getTextureCoordinates(S,n):null,le=e.hasVertexColors(S)?e.getVertexColors(S,n):null,be=e.getIndexData(S,n),we={transform:(0,b.b)(D),attributes:{position:yield ge,normal:ue?yield ue:null,texCoord0:ce?yield ce:null,color:le?yield le:null,tangent:ie?yield ie:null},indices:yield be,primitiveType:ae,material:he(_,yield xe,p)};let fe=null;(0,N.pC)(_.meta)&&(0,N.pC)(_.meta.ESRI_lod)&&"screenSpaceRadius"===_.meta.ESRI_lod.metric&&(fe=_.meta.ESRI_lod.thresholds[G]),_.lods[G]=_.lods[G]||{parts:[],name:re,lodThreshold:fe},_.lods[G].parts[se]=we});return function(S,D,G,re){return R.apply(this,arguments)}}());for(const R of _.lods)R.parts=R.parts.filter(S=>!!S);const C=yield e.getLoadedBuffersSize();return{model:_,meta:{isEsriSymbolResource:E,uri:e.uri},customMeta:{},size:C}}),ne.apply(this,arguments)}function me(i){let n=null;return i.json.nodes.forEach(a=>{const e=a.extras;(0,N.pC)(e)&&(e.ESRI_proxyEllipsoid||e.ESRI_lod)&&(n=e)}),n}function oe(){return oe=(0,h.Z)(function*(i,t){const n=i.json,a=n.scenes[n.scene||0].nodes,e=a.length>1,p=[];for(const A of a){const C=n.nodes[A];p.push(_(A,0)),ye(C)&&!e&&C.extensions.MSFT_lod.ids.forEach((R,S)=>_(R,S+1))}function _(A,C){return E.apply(this,arguments)}function E(){return(E=(0,h.Z)(function*(A,C){const R=n.nodes[A],S=i.getNodeTransform(A);if(null!=R.weights&&O.Z.getLogger("esri.views.3d.glTF").warn("[Unsupported Feature] Morph targets are not supported."),null!=R.mesh){const D=n.meshes[R.mesh];for(const G of D.primitives)p.push(t(G,S,C,D.name))}for(const D of R.children||[])p.push(_(D,C))})).apply(this,arguments)}yield Promise.all(p)}),oe.apply(this,arguments)}function ye(i){return i.extensions&&i.extensions.MSFT_lod&&Array.isArray(i.extensions.MSFT_lod.ids)}function he(i,t,n){const a=p=>{const _=`${n}_tex_${p&&p.id}${p&&p.name?"_"+p.name:""}`;if(p&&!i.textures.has(_)){const E=function g(i,t={}){return{data:i,parameters:{wrap:{s:c.e8.REPEAT,t:c.e8.REPEAT,...t.wrap},noUnpackFlip:!0,mipmap:!1,...t}}}(p.data,{wrap:{s:p.wrapS,t:p.wrapT},mipmap:Te.includes(p.minFilter),noUnpackFlip:!0});i.textures.set(_,E)}return _},e=`${n}_mat_${t.id}_${t.name}`;if(!i.materials.has(e)){const p=function d(i={}){return{color:[1,1,1],opacity:1,alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1,castShadows:!0,receiveShadows:!0,receiveAmbientOcclustion:!0,textureColor:null,textureNormal:null,textureOcclusion:null,textureEmissive:null,textureMetallicRoughness:null,colorTextureTransform:null,normalTextureTransform:null,occlusionTextureTransform:null,emissiveTextureTransform:null,metallicRoughnessTextureTransform:null,emissiveFactor:[0,0,0],metallicFactor:1,roughnessFactor:1,colorMixMode:"multiply",...i}}({color:[t.color[0],t.color[1],t.color[2]],opacity:t.color[3],alphaMode:t.alphaMode,alphaCutoff:t.alphaCutoff,doubleSided:t.doubleSided,colorMixMode:t.ESRI_externalColorMixMode,textureColor:t.colorTexture?a(t.colorTexture):void 0,textureNormal:t.normalTexture?a(t.normalTexture):void 0,textureOcclusion:t.occlusionTexture?a(t.occlusionTexture):void 0,textureEmissive:t.emissiveTexture?a(t.emissiveTexture):void 0,textureMetallicRoughness:t.metallicRoughnessTexture?a(t.metallicRoughnessTexture):void 0,emissiveFactor:[t.emissiveFactor[0],t.emissiveFactor[1],t.emissiveFactor[2]],colorTextureTransform:t.colorTextureTransform,normalTextureTransform:t.normalTextureTransform,occlusionTextureTransform:t.occlusionTextureTransform,emissiveTextureTransform:t.emissiveTextureTransform,metallicRoughnessTextureTransform:t.metallicRoughnessTextureTransform,metallicFactor:t.metallicFactor,roughnessFactor:t.roughnessFactor});i.materials.set(e,p)}return e}const Te=[c.cw.LINEAR_MIPMAP_LINEAR,c.cw.LINEAR_MIPMAP_NEAREST]},42743:(Z,M,y)=>{var h,O,N,b,c,d,g,o,l,s,u,r;y.d(M,{CE:()=>g,Gv:()=>O,JJ:()=>l,Rw:()=>b,Ti:()=>u,V_:()=>d,Vr:()=>h,hU:()=>c}),(r=h||(h={}))[r.None=0]="None",r[r.Front=1]="Front",r[r.Back=2]="Back",r[r.COUNT=3]="COUNT",function(r){r[r.Less=0]="Less",r[r.Lequal=1]="Lequal",r[r.COUNT=2]="COUNT"}(O||(O={})),function(r){r[r.BACKGROUND=0]="BACKGROUND",r[r.UPDATE=1]="UPDATE"}(N||(N={})),function(r){r[r.NOT_LOADED=0]="NOT_LOADED",r[r.LOADING=1]="LOADING",r[r.LOADED=2]="LOADED"}(b||(b={})),function(r){r[r.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded",r[r.OutlineVisualElementMask=2]="OutlineVisualElementMask"}(c||(c={})),function(r){r[r.Highlight=0]="Highlight",r[r.MaskOccludee=1]="MaskOccludee",r[r.COUNT=2]="COUNT"}(d||(d={})),function(r){r[r.STRETCH=1]="STRETCH",r[r.PAD=2]="PAD"}(g||(g={})),function(r){r[r.CHANGED=0]="CHANGED",r[r.UNCHANGED=1]="UNCHANGED"}(o||(o={})),function(r){r[r.Blend=0]="Blend",r[r.Opaque=1]="Opaque",r[r.Mask=2]="Mask",r[r.MaskBlend=3]="MaskBlend",r[r.COUNT=4]="COUNT"}(l||(l={})),function(r){r[r.OFF=0]="OFF",r[r.ON=1]="ON"}(s||(s={})),function(r){r.DDS_ENCODING="image/vnd-ms.dds",r.KTX2_ENCODING="image/ktx2",r.BASIS_ENCODING="image/x.basis"}(u||(u={}))},79331:(Z,M,y)=>{y.d(M,{K:()=>h});const h=2.1}}]);